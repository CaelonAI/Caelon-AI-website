<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Caelon AI - Automatiza y crece</title>
  <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@400;500;900&display=swap" rel="stylesheet" />
  <style>
    :root {
      --primary-color: #00F5A0;
      --secondary-color: #00D9F5;
      --dark-bg: #0a0a0a;
      --dark-card: #111111;
      --text-primary: #ffffff;
      --text-secondary: #a3a3a3;
      --accent-gradient: linear-gradient(90deg, #00F5A0, #00D9F5);
      --glow-color: rgba(0, 245, 160, 0.4);
      --neon-glow: 0 0 12px #00F5A0;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Exo 2', sans-serif;
      background: var(--dark-bg);
      color: var(--text-primary);
      line-height: 1.6;
      overflow-x: hidden;
      scroll-behavior: smooth;
    }
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--dark-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      opacity: 1;
      transition: opacity 0.5s ease;
    }
    .loading-overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }
    .loader {
      width: 60px;
      height: 60px;
      border: 3px solid rgba(0, 245, 160, 0.1);
      border-top: 3px solid var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }
    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }
    .particle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: var(--primary-color);
      border-radius: 50%;
      opacity: 0.25;
      animation: float-particles 22s infinite linear;
    }
    @keyframes float-particles {
      0% {
        transform: translateY(100vh) rotate(0deg);
        opacity: 0;
      }
      10% {
        opacity: 0.3;
      }
      90% {
        opacity: 0.3;
      }
      100% {
        transform: translateY(-100px) rotate(360deg);
        opacity: 0;
      }
    }
    /* Barra de navegaci√≥n centrada y compacta */
    nav {
      position: fixed;
      top: 0;
      width: 100%;
      padding: 0.2rem 1rem;
      background: rgba(10, 10, 10, 0.1);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      z-index: 1000;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      transition: all 0.3s ease;
      display: flex;
      justify-content: center;
    }
    nav.scrolled {
      background: rgba(10, 10, 10, 0.95);
      box-shadow: 0 8px 32px rgba(0, 245, 160, 0.1);
      transform: translateY(0);
    }
    .nav-container {
      width: 100%;
      max-width: 1400px;
      padding: 0 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    @media (max-width: 768px) {
      nav {
        padding: 1rem 1rem;
      }
      .nav-container {
        padding: 0 1rem;
        flex-direction: column;
      }
    }
    .logo {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-family: 'Exo 2', sans-serif;
      font-weight: 900;
      font-size: 1.5rem;
      color: var(--text-primary);
      text-shadow: var(--neon-glow);
    }
    /* Logo m√°s grande acorde a la tipograf√≠a */
    .logo-image {
      width: 90px;
      height: 90px;
      object-fit: contain;
      filter: drop-shadow(0 0 8px rgba(0, 245, 160, 0.5));
      animation: logo-pulse 4s ease-in-out infinite;
    }
    @keyframes logo-pulse {
      0%, 100% {
        filter: drop-shadow(0 0 8px rgba(0, 245, 160, 0.5)) scale(1);
      }
      50% {
        filter: drop-shadow(0 0 15px rgba(0, 245, 160, 0.8)) scale(1.05);
      }
    }
    .nav-links {
      display: flex;
      gap: 2rem;
      list-style: none;
    }
    .nav-links a {
      color: var(--text-secondary);
      text-decoration: none;
      font-weight: 500;
      padding: 0.5rem 1rem;
      border-radius: 25px;
      font-family: 'Exo 2', sans-serif;
      transition: all 0.3s;
      cursor: pointer;
    }
    .nav-links a:hover {
      color: var(--primary-color);
      background: rgba(0, 245, 160, 0.1);
      transform: translateY(-2px);
      text-shadow: 0 0 8px rgba(0, 245, 160, 0.6);
    }
    @media (max-width: 768px) {
      .nav-links {
        display: none;
      }
      .nav-container {
        flex-direction: column;
      }
      .section {
        padding: 4rem 1rem;
      }
    }
    .hero {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      position: relative;
      padding: 0 2rem;
      overflow: hidden;
    }
    .hero-video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      z-index: -2;
      pointer-events: none;
    }
    .hero-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(10, 10, 10, 0.65);
      z-index: -1;
    }
    .hero-content {
      max-width: 700px;
      margin-left: 10%;
      z-index: 2;
      position: relative;
    }
    .hero h1 {
      font-size: clamp(2.5rem, 6vw, 5rem);
      font-weight: 900;
      font-family: 'Exo 2', sans-serif;
      margin-bottom: 1.5rem;
      color: #FFFFFF;
      text-shadow: var(--neon-glow);
      line-height: 1.1;
      letter-spacing: -0.02em;
    }
    .hero p {
      font-size: 1.25rem;
      font-family: 'Exo 2', sans-serif;
      font-weight: 400;
      color: #FFFFFF;
      text-shadow: 0 0 8px rgba(0, 245, 160, 0.3);
      margin-bottom: 3rem;
      line-height: 1.7;
    }
    .cta-button {
      display: inline-flex;
      align-items: center;
      gap: 0.75rem;
      padding: 1.4rem 3rem;
      background: var(--accent-gradient);
      color: #FFFFFF;
      text-decoration: none;
      border-radius: 999px;
      font-weight: 500;
      font-size: 1.1rem;
      font-family: 'Exo 2', sans-serif;
      transition: all 0.4s;
      box-shadow: 0 10px 30px rgba(0, 245, 160, 0.3);
      border: none;
      cursor: pointer;
    }
    .cta-button:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 0 30px rgba(0, 245, 160, 0.6), 0 20px 50px rgba(0, 245, 160, 0.3);
    }
    .cta-button:disabled {
      background: #6c757d !important;
      cursor: not-allowed !important;
      opacity: 0.6 !important;
      transform: none !important;
      box-shadow: none !important;
    }

    .section {
      padding: 8rem 2rem;
      max-width: 1400px;
      margin: 0 auto;
      position: relative;
    }
    .section h2 {
      font-size: clamp(2rem, 5vw, 3rem);
      font-weight: 900;
      font-family: 'Exo 2', sans-serif;
      text-align: center;
      margin-bottom: 4rem;
      color: #FFFFFF;
      text-shadow: var(--neon-glow);
      position: relative;
    }
    .services-grid,
    .process-steps {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 3rem;
      margin-top: 5rem;
    }
    .service-card,
    .process-step {
      background: var(--dark-card);
      border-radius: 22px;
      padding: 3rem 2rem;
      text-align: center;
      box-shadow: 0 2px 30px rgba(0, 245, 160, 0.06);
      transition: transform 0.18s cubic-bezier(0.5, 1.45, 0.49, 0.99), box-shadow 0.18s;
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }
    .service-card:hover,
    .process-step:hover {
      transform: translateY(-10px) scale(1.06) rotate(-2deg);
      box-shadow: 0 7px 40px rgba(0, 245, 160, 0.17), 0 0 32px 0px var(--primary-color);
      z-index: 10;
    }
    /* Iconos como imagenes con tama√±o fijo y efecto hover */
    .service-icon {
      margin-bottom: 1.3rem;
      display: inline-block;
      width: 70px;
      height: 70px;
      object-fit: contain;
      filter: drop-shadow(0 0 12px #00f5a077);
      transition: filter 0.24s, transform 0.24s;
    }
    .service-card:hover .service-icon {
      filter: drop-shadow(0 0 28px #00a0a0cc);
      transform: scale(1.13) rotate(3deg);
    }

    .step-number {
      background: var(--accent-gradient);
      color: #121212;
      border-radius: 50%;
      width: 62px;
      height: 62px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 900;
      font-size: 2.2rem;
      margin: 0 auto 1.2rem;
      box-shadow: 0 0 20px rgb(0, 245, 160, 0.16);
      border: 3px solid #1f1f1f;
    }
    .process-step {
      min-height: 260px;
    }
    .contact {
      background: linear-gradient(135deg, rgba(17, 17, 17, 0.9) 0%, rgba(17, 17, 17, 0.7) 100%);
      border-radius: 30px;
      padding: 5rem;
      text-align: center;
      margin-top: 6rem;
      border: 1px solid rgba(255, 255, 255, 0.1);
      position: relative;
      overflow: hidden;
    }
    form .form-group {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 1rem;
    }
    form input,
    form select {
      padding: 1rem;
      border-radius: 10px;
      border: none;
      background: #181818;
      color: #fff;
      margin-bottom: 0;
      width: 100%;
      max-width: 300px;
      font-family: 'Exo 2', sans-serif;
      font-size: 1rem;
      box-shadow: 0 1px 6px rgba(0, 245, 160, 0.04);
      transition: border 0.2s;
    }
    form input:focus,
    form select:focus {
      outline: none;
      border: 2px solid var(--primary-color);
    }
    @media (max-width: 768px) {
      .section {
        padding: 4rem 1rem;
      }
      .services-grid,
      .process-steps {
        grid-template-columns: 1fr;
        gap: 2rem;
      }
      .contact {
        padding: 3rem 2rem;
        margin-top: 4rem;
      }
      .hero-content {
        margin-left: 0;
        max-width: 100%;
      }
      .hero-video,
      .hero-overlay {
        width: 100vw;
        height: 100vh;
      }
      .service-card,
      .process-step {
        padding: 2.5rem 1.2rem;
      }
      .service-icon,
      .step-number {
        width: 46px;
        height: 46px;
        font-size: 2.2rem;
      }
      form .form-group {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <!-- Loader -->
  <div class="loading-overlay" id="loading">
    <div class="loader"></div>
  </div>

  <!-- Part√≠culas flotantes -->
  <div class="particles" id="particles"></div>

  <!-- Navegaci√≥n -->
  <nav id="navbar">
    <div class="nav-container">
      <div class="logo">
        <img src="./images/Logo.png" alt="Caelon AI Logo" class="logo-image" />
        <span>Caelon AI</span>
      </div>
      <ul class="nav-links">
        <li><a href="#servicios">Descubre c√≥mo lo hacemos</a></li>
        <li><a href="#proceso">Proceso</a></li>
        <li><a href="#contacto">Contacto</a></li>
      </ul>
    </div>
  </nav>

  <!-- HERO SECTION -->
  <section class="hero">
    <video class="hero-video" autoplay muted loop playsinline>
      <source src="./images/Fondo-Hero-section.mp4" type="video/mp4" />
      Tu navegador no soporta videos HTML5.
    </video>
    <div class="hero-overlay"></div>
    <div class="hero-content">
      <h1>Automatiza y crece.<br />Factura m√°s, trabaja menos.</h1>
      <p>Convierte tus procesos en ganancias con automatizaciones inteligentes que trabajan 24/7 por ti.</p>
      <a href="#contacto" class="cta-button">
        ¬°Agenda tu demo! <span class="icon">üöÄ</span>
      </a>
    </div>
  </section>

  <!-- Descubre c√≥mo lo hacemos (antes Servicios) -->
  <section id="servicios" class="section">
    <h2>Descubre c√≥mo lo hacemos</h2>
    <div class="services-grid">
      <div class="service-card">
        <img src="./images/ciencia.png" alt="Automatizaci√≥n de Procesos" class="service-icon" />
        <h3>Automatizaci√≥n de Procesos</h3>
        <p>Optimiza y automatiza tus flujos de trabajo con soluciones inteligentes y personalizadas.</p>
      </div>
      <div class="service-card">
        <img src="./images/asistente-de-ai.png" alt="Chatbots y Soporte 24/7" class="service-icon" />
        <h3>Chatbots y Soporte 24/7</h3>
        <p>Asistentes virtuales que atienden y resuelven las dudas de tus clientes a cualquier hora.</p>
      </div>
      <div class="service-card">
        <img src="./images/grafico-de-negocios.png" alt="Integraci√≥n de IA en Negocios" class="service-icon" />
        <h3>Integraci√≥n de IA en Negocios</h3>
        <p>Lleva tu negocio al siguiente nivel con inteligencia artificial especializada en ventas y atenci√≥n.</p>
      </div>
    </div>
  </section>

  <!-- Proceso -->
  <section id="proceso" class="section">
    <h2>¬øC√≥mo trabajamos?</h2>
    <div class="process-steps">
      <div class="process-step">
        <div class="step-number">1</div>
        <h4>Diagn√≥stico</h4>
        <p>Analizamos tus procesos y necesidades.</p>
      </div>
      <div class="process-step">
        <div class="step-number">2</div>
        <h4>Propuesta</h4>
        <p>Dise√±amos una soluci√≥n a la medida para tu negocio.</p>
      </div>
      <div class="process-step">
        <div class="step-number">3</div>
        <h4>Implementaci√≥n</h4>
        <p>Desplegamos y personalizamos la automatizaci√≥n.</p>
      </div>
      <div class="process-step">
        <div class="step-number">4</div>
        <h4>Soporte</h4>
        <p>Monitoreo y mejora continua para obtener los mejores resultados.</p>
      </div>
    </div>
  </section>

  <!-- Contacto -->
  <section id="contacto" class="section">
    <div class="contact">
      <h3>¬øListo para automatizar tu negocio?</h3>
      <p>Escr√≠benos y lleva tu empresa al siguiente nivel con la ayuda de Caelon AI.</p>
      <form action="https://script.google.com/macros/s/AKfycby-GAG76vQIkPFayWtDNfzNlAadKxdIpWrY1_ngaicj_d5bOvcBaku12uzYR3fpaCle/exec" method="POST" id="caelonForm" onsubmit="handleSubmit(event)">
        <div class="form-group">
          <input type="text" name="nombre" placeholder="Tu nombre" required />
          <input type="text" name="apellido" placeholder="Apellido" required />
        </div>
        <div class="form-group">
          <input type="email" name="correo" placeholder="Correo electr√≥nico" required />
          <input type="text" name="telefono" placeholder="Numero de Telefono" optional />
          <input type="text" name="empresa" placeholder="Empresa / Agencia" required />
        </div>
        <div class="form-group" style="flex-direction: column; align-items: center;">
          <select name="mensaje" required>
            <option value="" disabled selected hidden>¬øQu√© te interesa automatizar?</option>
            <option value="Crear o integrar un chatbot inteligente (WhatsApp, Web, Telegram, etc.)">
              Crear o integrar un chatbot inteligente (WhatsApp, Web, Telegram, etc.)
            </option>
            <option value="Automatizar tareas repetitivas (emails, reportes, formularios‚Ä¶)">
              Automatizar tareas repetitivas (emails, reportes, formularios‚Ä¶)
            </option>
            <option value="Integrar m√∫ltiples herramientas (CRM, Google Sheets, APIs‚Ä¶)">
              Integrar m√∫ltiples herramientas (CRM, Google Sheets, APIs‚Ä¶)
            </option>
            <option value="Mejorar procesos internos (ventas, soporte, recursos humanos‚Ä¶)">
              Mejorar procesos internos (ventas, soporte, recursos humanos‚Ä¶)
            </option>
            <option value="Necesito asesor√≠a para automatizar procesos de mi empresa">
              Necesito asesor√≠a para automatizar procesos de mi empresa
            </option>
            <option value="Solo estoy consultando / buscando informaci√≥n">
              Solo estoy consultando / buscando informaci√≥n
            </option>
            <option value="Otro (especificar)">Otro (especificar)</option>
          </select>
          <input
            type="text"
            name="mensaje_otro"
            id="mensaje_otro"
            placeholder="Por favor, cu√©ntanos"
            style="display:none; margin-top:10px; max-width: 300px; width: 100%;"
            maxlength="200"
          />
        </div>
        <button type="submit" class="cta-button">Enviar</button>
        <p id="form-response" style="margin-top: 10px;"></p>
      </form>
    </div>
  </section>

  <footer style="text-align:center; padding: 2rem 0; color: #a3a3a3;">
    ¬© 2025 Caelon AI - Todos los derechos reservados.
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Loader simple
      setTimeout(() => {
        document.getElementById('loading').classList.add('hidden');
      }, 900);

      // Navbar fondo din√°mico al hacer scroll
      window.addEventListener('scroll', function () {
        const navbar = document.getElementById('navbar');
        if (window.scrollY > 20) navbar.classList.add('scrolled');
        else navbar.classList.remove('scrolled');
      });

      // Part√≠culas flotantes
      function spawnParticles() {
        const container = document.getElementById('particles');
        for (let i = 0; i < 32; i++) {
          const p = document.createElement('div');
          p.className = 'particle';
          p.style.left = Math.random() * 100 + '%';
          p.style.top = Math.random() * 100 + 'vh';
          p.style.animationDuration = 17 + Math.random() * 8 + 's';
          container.appendChild(p);
        }
      }
      spawnParticles();

      // Mostrar el campo "mensaje_otro" solo si seleccionan "Otro (especificar)"
      var select = document.querySelector('select[name="mensaje"]');
      var inputOtro = document.getElementById('mensaje_otro');
      if (select && inputOtro) {
        select.addEventListener('change', function () {
          if (this.value === 'Otro (especificar)') {
            inputOtro.style.display = 'block';
            inputOtro.required = true;
          } else {
            inputOtro.style.display = 'none';
            inputOtro.required = false;
            inputOtro.value = '';
          }
        });
      }

      // Scroll suave para enlaces con hash en la navegaci√≥n
      const allHashLinks = document.querySelectorAll('a[href^="#"]'); // Cambiar selector
      allHashLinks.forEach(link => {
      link.addEventListener('click', function (e) {
      e.preventDefault();
      const targetId = this.getAttribute('href').substring(1);
      const targetElem = document.getElementById(targetId);
      if (!targetElem) return;

      const offset = 70; // Altura navbar para evitar que tape contenido
      const targetPosition = targetElem.getBoundingClientRect().top + window.pageYOffset - offset;

      window.scrollTo({
      top: targetPosition,
      behavior: 'smooth'
    });
  });
});

   function handleSubmit(e) {
  e.preventDefault();
  const form = document.getElementById('caelonForm');
  const response = document.getElementById('form-response');
  const submitButton = document.querySelector('button[type="submit"]'); // Obtener el bot√≥n

  // DESACTIVAR EL BOT√ìN
  submitButton.disabled = true;
  submitButton.style.opacity = '0.6';
  submitButton.style.cursor = 'not-allowed';
  submitButton.innerHTML = 'Enviando...'; // Cambiar texto del bot√≥n

  const formData = new FormData(form);

  fetch(form.action, {
    method: 'POST',
    body: formData,
  })
    .then((res) => res.json())
    .then(() => {
      response.textContent = '‚úÖ ¬°Formulario enviado con √©xito!';
      response.style.color = 'limegreen';
      form.reset();
      // Ocultar input "otro" despu√©s del reset
      var inputOtro = document.getElementById('mensaje_otro');
      if (inputOtro) {
        inputOtro.style.display = 'none';
        inputOtro.required = false;
      }

      // REACTIVAR EL BOT√ìN CUANDO APAREZCA EL MENSAJE DE √âXITO
      submitButton.disabled = false;
      submitButton.style.opacity = '1';
      submitButton.style.cursor = 'pointer';
      submitButton.innerHTML = 'Enviar'; // Restaurar texto original
    })
    .catch(() => {
      response.textContent = '‚ùå Hubo un error al enviar el formulario.';
      response.style.color = 'red';

      // REACTIVAR EL BOT√ìN TAMBI√âN EN CASO DE ERROR
      submitButton.disabled = false;
      submitButton.style.opacity = '1';
      submitButton.style.cursor = 'pointer';
      submitButton.innerHTML = 'Enviar'; // Restaurar texto original
    });
    }
  </script>

<!-- CHATBOT MANUAL - Implementaci√≥n directa -->
<script>
  console.log("ü§ñ Creando chatbot manual para Caelon AI...");
  
  class CaelonChatbot {
    constructor() {
      this.isOpen = false;
      this.sessionId = this.generateSessionId();
      this.webhookUrl = "https://n8n-n8n.a6mo3g.easypanel.host/webhook/c29801dd-6281-4e87-9c3f-7d6d00f5db5d/chat";
      this.createChatbot();
    }
    
    generateSessionId() {
      return 'session_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();
    }
    
    createChatbot() {
      // Crear el bot√≥n flotante
      this.launcher = document.createElement('div');
      this.launcher.innerHTML = `
        <div id="caelon-chat-launcher" style="
          position: fixed;
          bottom: 20px;
          right: 20px;
          width: 60px;
          height: 60px;
          background: #4FA8F0;
          border-radius: 50%;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          box-shadow: 0 4px 12px rgba(79, 168, 240, 0.3);
          z-index: 9999;
          transition: all 0.3s ease;
          color: white;
          font-size: 24px;
        ">
          üí¨
        </div>
      `;
      
      // Crear la ventana del chat
      this.chatWindow = document.createElement('div');
      this.chatWindow.innerHTML = `
        <div id="caelon-chat-window" style="
          position: fixed;
          bottom: 90px;
          right: 20px;
          width: 350px;
          height: 500px;
          background: #1A2634;
          border-radius: 15px;
          box-shadow: 0 8px 30px rgba(0,0,0,0.3);
          z-index: 9999;
          display: none;
          flex-direction: column;
          overflow: hidden;
        ">
          <!-- Header -->
          <div style="
            background: #4FA8F0;
            padding: 15px;
            color: white;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
          ">
            <span>Caelum</span>
            <span id="caelon-chat-close" style="cursor: pointer; font-size: 20px;">√ó</span>
          </div>
          
          <!-- Messages area -->
          <div id="caelon-chat-messages" style="
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background: #1A2634;
            color: white;
          ">
            <div style="
              background: #4FA8F0;
              color: white;
              padding: 10px;
              border-radius: 10px;
              margin-bottom: 10px;
              font-size: 14px;
            ">
              ¬°Hola! Soy Caelum el asistente de Caelon AI. ¬øEn qu√© puedo ayudarte hoy?
            </div>
          </div>
          
          <!-- Input area -->
          <div style="
            padding: 15px;
            border-top: 1px solid #333;
            background: #1A2634;
          ">
            <div style="display: flex; gap: 10px;">
              <input 
                id="caelon-chat-input" 
                type="text" 
                placeholder="Escribe tu mensaje..."
                style="
                  flex: 1;
                  padding: 10px;
                  border: none;
                  border-radius: 20px;
                  background: #333;
                  color: white;
                  outline: none;
                "
              />
              <button id="caelon-chat-send" style="
                background: #4FA8F0;
                border: none;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                color: white;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
              ">
                ‚û§
              </button>
            </div>
          </div>
        </div>
      `;
      
      document.body.appendChild(this.launcher);
      document.body.appendChild(this.chatWindow);
      
      this.bindEvents();
      console.log("üéâ Chatbot manual creado exitosamente");
    }
    
    bindEvents() {
      const launcher = document.getElementById('caelon-chat-launcher');
      const closeBtn = document.getElementById('caelon-chat-close');
      const sendBtn = document.getElementById('caelon-chat-send');
      const input = document.getElementById('caelon-chat-input');
      const window = document.getElementById('caelon-chat-window');
      
      // Hover effects
      launcher.addEventListener('mouseenter', () => {
        launcher.style.background = '#6FC0FF';
        launcher.style.transform = 'scale(1.1)';
      });
      
      launcher.addEventListener('mouseleave', () => {
        launcher.style.background = '#4FA8F0';
        launcher.style.transform = 'scale(1)';
      });
      
      // Toggle chat
      launcher.addEventListener('click', () => this.toggleChat());
      closeBtn.addEventListener('click', () => this.toggleChat());
      
      // Send message
      sendBtn.addEventListener('click', () => this.sendMessage());
      input.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') this.sendMessage();
      });
    }
    
    toggleChat() {
      const window = document.getElementById('caelon-chat-window');
      this.isOpen = !this.isOpen;
      window.style.display = this.isOpen ? 'flex' : 'none';
      
      if (this.isOpen) {
        document.getElementById('caelon-chat-input').focus();
      }
    }
    
    async sendMessage() {
      const input = document.getElementById('caelon-chat-input');
      const message = input.value.trim();
      
      if (!message) return;
      
      // Add user message to chat
      this.addMessage(message, 'user');
      input.value = '';
      
      // Add thinking indicator
      const thinkingId = this.addMessage('Escribiendo...', 'bot', true);
      
      try {
        // Send to n8n webhook
        const response = await fetch(this.webhookUrl, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            action: 'sendMessage',
            sessionId: this.sessionId,
            chatInput: message
          })
        });
        
        const data = await response.json();
        console.log('Respuesta del webhook:', data);
        
        // Remove thinking indicator
        document.getElementById(thinkingId).remove();
        
        // Add bot response
        const botMessage = data.output || data.chatOutput || data.response || 'Lo siento, no pude procesar tu mensaje.';
        this.addMessage(botMessage, 'bot');
        
      } catch (error) {
        console.error('Error sending message:', error);
        document.getElementById(thinkingId).remove();
        this.addMessage('Lo siento, hubo un error. Int√©ntalo de nuevo.', 'bot');
      }
    }
    
    addMessage(text, sender, isTemporary = false) {
      const messagesContainer = document.getElementById('caelon-chat-messages');
      const messageId = 'msg_' + Date.now() + '_' + Math.random().toString(36).substr(2, 5);
      
      const messageDiv = document.createElement('div');
      messageDiv.id = messageId;
      messageDiv.style.cssText = `
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 10px;
        font-size: 14px;
        max-width: 80%;
        ${sender === 'user' ? `
          background: #4FA8F0;
          color: white;
          margin-left: auto;
          text-align: right;
        ` : `
          background: #333;
          color: white;
          margin-right: auto;
        `}
        ${isTemporary ? 'opacity: 0.7; font-style: italic;' : ''}
      `;
      
      messageDiv.textContent = text;
      messagesContainer.appendChild(messageDiv);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
      
      return messageId;
    }
  }
  
  // Inicializar el chatbot cuando la p√°gina est√© lista
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => new CaelonChatbot());
  } else {
    new CaelonChatbot();
  }
</script>
</body>
</html>
